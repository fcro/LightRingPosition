
<!DOCTYPE html>
<html>
<head>
<title>Chat</title>
<link type="text/css" rel="stylesheet" href="tchat.css" />
</head>
<body>
<div id="wrapper">
    <div id="menu">
        <p class="welcome">Bienvenue dans le tchat.<b></b></p>
        <p class="logout"><a id="exit" href="#"> Sortir du tchat</a></p>
        <div style="clear:both"></div>
    </div>
     
    <div id="chatbox"></div>
     
    <form name="message" method="get">
        <input name="usermsg" type="text" id="usermsg" size="63" />
        <input name="submitmsg" type="submit"  id="submitmsg" value="Send"/>
    </form>
</div>
<script>
	$("#submitmsg").click(function(){
		var html = Document.getElementById("usermsg");		
		var oldscrollHeight = $("#chatbox").attr("scrollHeight") - 20; //Scroll height before the request
		$.ajax({
			type:"post",
			data:html,
			url: "webapi/tchat/send ",
			cache: false,
			success: function(html){		
				$("#chatbox").html(html); //Insert chat log into the #chatbox div	
				
				//Auto-scroll			
				var newscrollHeight = $("#chatbox").attr("scrollHeight") - 20; //Scroll height after the request
				if(newscrollHeight > oldscrollHeight){
					$("#chatbox").animate({ scrollTop: newscrollHeight }, 'normal'); //Autoscroll to bottom of div
				}				
		  	},
		});
	}
function loadLog(){
$.ajax({
type: "get",
url: "webapi/tchat",
success: function(html){		
				$("#chatbox").html(html);
}
});
}
setInterval (loadLog, 2500);	//Reload file every 2500 ms 
</script>

</body>
</html>

